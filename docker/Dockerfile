FROM harbor.jkstack.com/sre/base_image:v1
MAINTAINER Zili

WORKDIR /opt/jkexec

COPY jksreExecEngine jksreExecEngine
COPY entrypoint.sh entrypoint.sh

# 设置环境变量
ENV EXEC_ENGINE_IP 127.0.0.1
ENV EXEC_ENGINE_NAME ZiliTest
ENV DPA_ADDRESS 127.0.0.1
ENV RABBITMQ_ADDR amqp://admin:admin@127.0.0.1:5672/zone01
ENV ELASTICSEARCH_ADDR http://127.0.0.1:9200
ENV SMART_AGENT_SERVER_PORT 127.0.0.1
ENV SMART_AGENT_SERVER_PORT 13080
ENV EXEC_WORKER_CONCURRENCY 8
ENV EXEC_WORKER_TASK_TIMEOUT 7200


EXPOSE 8093 4505 4506 22 5555 9001

STOPSIGNAL SIGQUIT

CMD ["./entrypoint.sh"]

ENTRYPOINT ["/tini", "--"]